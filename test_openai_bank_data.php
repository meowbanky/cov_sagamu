<?php
require_once('config/EnvConfig.php');
require_once 'vendor/autoload.php';

echo "<h1>OpenAI Bank Data Analysis Test</h1>";

$openai_key = EnvConfig::getOpenAIKey();
echo "<p>OpenAI Key: " . (!empty($openai_key) ? '‚úÖ Configured (' . strlen($openai_key) . ' chars)' : '‚ùå Not configured') . "</p>";

if (empty($openai_key)) {
    echo "<p style='color: red;'>No OpenAI key found!</p>";
    exit();
}

// Sample bank statement text (similar to what we extracted)
$sample_text = "ZENITH BANK PLC  ACCOUNT NAME: VICTORY SAGAMU REMO COOP MULTI SOC LTD Current Account Statement Period: 01-JUN-2025 TO 30-JUN-2025 CURRENCY: NGN   ACCOUNT No.: 1015222777 DATE   DESCRIPTION   DEBIT   CREDIT   VALUE DATE   BALANCE Opening Balance   16,413,025.93 01/06/2025   TRF FROM TOLANIKAWO JEJELOLA ADEBAJO//TRF TO VICTORY SAGAMU REMO COOP MULTI SOC LTD//Savings 150,000.00 01/06/2025   16,563,025.93 01/06/2025   FGN ELECTRONIC MONEY TRANSFER LEVY   2,250.00   01/06/2025   16,560,775.93 01/06/2025   NIP/UBN/LTD   FLICKELEK NIGERIA LTD /MOBILE/UNION Transfer from LTD FLICKELEK NIGERIA LTD - loan repayments 35,000.00 01/06/2025   16,595,775.93 02/06/2025   NIP/ABN/THEOPHILUS AIVBELOSUOGHENE UWANOGHO/TRFRentFRM THEOPHILUS AIVBELOSUOGHENE UWANOGHO TO VICTORY SAGAMU REMO COOP M 200,000.00 02/06/2025   16,795,775.93 02/06/2025   CIP/CR//Transfer from OLUWATOSIN IBUKUN IBIGBAMI 100004250602065250133930086343 10,000.00 02/06/2025   16,805,775.93 02/06/2025   CIP/CR//savings and shares 100004250602085735133938324661/FRM OLASUNKANMI OLUWOLE OGUNEKUN 20,000.00 02/06/2025   16,825,775.93 02/06/2025   NIP/STBC/TEMILADE BUKOLA OSIDIBO/Bukola Osidibo   175,000.00 02/06/2025   17,000,775.93 02/06/2025   CIP/CR//NIP Transfer to VICTORY SAGAMU REMO COOP MULTI SOC LTD. 000013250602205638000199979981 000199979981/FRM AJANAKU 20,000.00 02/06/2025   17,020,775.93 02/06/2025   CIP/CR//Transfer from AYOKUNLE OLUGBENGA FAMUYWA 100004250602200539133991168689 150,000.00 02/06/2025   17,170,775.93 03/06/2025   NIP/ROLEZ/M   D TOTOD GLOBAL VENTURES/Transfer from Samuel Osidibo/AT68 TRF2MPT6v3l91929792019632078848 340,000.00 03/06/2025   17,510,775.93 03/06/2025   Loan to Omolade v /CIB//NIP TFR TO FATADE OMOLADE VICTORIA/GTB   2,000,000.00   03/06/2025   15,510,775.93 03/06/2025   NIP CHARGE + VAT   53.75   03/06/2025   15,510,722.18 03/06/2025   Loan to oluwasaanu/CIB//NIP TFR TO FATADE TIMOTHY OLUWASANU/GTB   2,000,000.00   03/06/2025   13,510,722.18 03/06/2025   NIP CHARGE + VAT   53.75   03/06/2025   13,510,668.43 03/06/2025   Loan to Mrs Adebayo /CIB//NIP TFR TO GRACE OLUBUNMI ADEBAYO/STBC   1,200,000.00   03/06/2025   12,310,668.43 03/06/2025   NIP CHARGE + VAT   53.75   03/06/2025   12,310,614.68 03/06/2025   Part withdrawal Oluwaseun O Ogunda/CIB//NIP TFR TO OLATUNDE OGUNDARE/SKYE   50,000.00   03/06/2025   12,260,614.68 03/06/2025   NIP CHARGE + VAT   26.88   03/06/2025   12,260,587.80 03/06/2025   Loan to daddy Osidibo /CIB//NIP TFR TO OSIDIBO SAMUEL OMOLOLU/SKYE   5,000,000.00   03/06/2025   7,260,587.80 03/06/2025   NIP CHARGE + VAT   53.75   03/06/2025   7,260,534.05 03/06/2025   Loan to Salau Abiodun /CIB//NIP TFR TO SALAWU AANUOLUWAPO ABIODUN/GTB   450,000.00   03/06/2025   6,810,534.05 03/06/2025   NIP CHARGE + VAT   53.75   03/06/2025   6,810,480.30 03/06/2025   :ETZ INFLOW 09FG250603141129437Y9KSDN:Adejoke Adekoya 50,000.00 03/06/2025   6,860,480.30 04/06/2025   :ETZ INFLOW 09FG250604125751137LEIK1T:NXG :TRFGARETHFRM KEHINDE VICTORIA GARET 500,000.00 04/06/2025   7,360,480.30 04/06/2025   Cash Deposit/ds00977765/orina adunni   25,000.00 04/06/2025   7,385,480.30 04/06/2025   :ETZ INFLOW 09FG2506041745513280KKQP6:Transfer from PAUL OLORUNSOGO ODUSANYA;9 10,000.00 04/06/2025   7,395,480.30  Page 1 of 6
04/06/2025   :ETZ INFLOW 09FG250604175828528XUCV47:number 127 abosede Aderonke Daniel 15,000.00 04/06/2025   7,410,480.30 04/06/2025   :ETZ INFLOW 09FG25060419014828560WYY2:NXG :TRFDR ADEJUMOFRM OLUSOLA ADEDEJI AD 2,500,000.00 04/06/2025   9,910,480.30 05/06/2025   NIP/STBC/MODUPE OGUNSANYA/Contribution for Jun   20,000.00 04/06/2025   9,930,480.30 05/06/2025   CIP/CR//Adejoke Adekoya to VICTORY SAGAMU REMO COOP MULTI SOC LTD. 000013250605115139000206046809 000206046809/FRM ADEK 50,000.00 05/06/2025   9,980,480.30 05/06/2025   :ETZ INFLOW 09FG250605122322752M1LIBU:Transfer from AARON IREOLUWA OLOGUN;8109 20,000.00 05/06/2025   10,000,480.30 05/06/2025   Account Transfer frm GRACE GIMBIYA ITODO to VICTORY SAGAMU REMO COOP MULTI SOC LTD-mrs Josephine Itodo 500,000.00 05/06/2025   10,500,480.30 05/06/2025   CIP/CR//Loan repayment to VICTORY SAGAMU REMO COOP MULTI SOC LTD. 000013250605131241000206296146 000206296146/FRM OTUBU 12,000.00 05/06/2025   10,512,480.30 05/06/2025   NIP/FCMB/OYELADE OLUWATOYIN OLAMIDE/AppOyelade Oluwatoyin To Zenith Bank VICTORY SAGAMU REMO COO 20,000.00 05/06/2025   10,532,480.30 05/06/2025   :ETZ INFLOW 09FG250605215112829OXIOPT:Transfer from OLAWUNMI ADEOLA BABALOLA;8 15,000.00 05/06/2025   10,547,480.30 05/06/2025   :ETZ INFLOW 09FG250605215909934XA0CS3:QR TRF FRM JOHNSON ADEOLA RALIAT 20,000.00 05/06/2025   10,567,480.30 06/06/2025   :ETZ INFLOW 09FG250606162148202OX978X:Cooperative Savings 15,000.00 06/06/2025   10,582,480.30 06/06/2025   NIP/FBN/YAKUBU JAFARU BANKOLE ESQ/USSD YAKUBU JAFARU BANKOLE ESQ   30,000.00 06/06/2025   10,612,480.30 08/06/2025   FGN ELECTRONIC MONEY TRANSFER LEVY   1,150.00   08/06/2025   10,611,330.30 08/06/2025   CIP/CR//Loan repayment to VICTORY SAGAMU REMO COOP MULTI SOC LTD. 000013250608035524000211726300 000211726300/FRM OLOGU 100,000.00 08/06/2025   10,711,330.30 08/06/2025   CIP/CR//USSD NIP Transfer from 07030243901 to VICTORY SAGAMU REMO COOP MULTI SOC LTD. 000013250608072713000 0002117980 49,500.00 08/06/2025   10,760,830.30 08/06/2025   UP-IB Online Transfer/000004250608104139680670443776| UPI- 1613320Lu3N5Uvv5lmD587//20250608/MOB/U TO/VICTORY SAGAMU/lolo hyacinth/31085617149|ANUOLUWAPO ALAKE HYACINTH 200,000.00 08/06/2025   10,960,830.30 08/06/2025   UP-IB Online Transfer/000004250608190052383522954199| UPI- 1643168Wr56nlpoekW8IC0//20250608/MOB/U TO/VICTORY SAGAMU/AYOKUNLE FAMUYI/31092611205|AYOJOY VENTURES 300,000.00 08/06/2025   11,260,830.30 09/06/2025   CIP/CR//Loan repayment to VICTORY SAGAMU REMO COOP MULTI SOC LTD. 000013250609090027000213370349 000213370349/FRM KEHIN 2,500.00 09/06/2025   11,263,330.30 10/06/2025   Loan to Dr Kehinde /CIB//NIP TFR TO KEHINDE OMOLARA ADEOLU/GTB   2,000,000.00   10/06/2025   9,263,330.30 10/06/2025   NIP CHARGE + VAT   53.75   10/06/2025   9,263,276.55 10/06/2025   :ETZ INFLOW 09FG250610105532003XTS3AT:NXG :TRFDARAS REPAYMENTFRM ABIMBOLA ADEY 60,000.00 10/06/2025   9,323,276.55 10/06/2025   NIP/FBN/OLADELE JANET MODUPELOWA/FBNMOBILE VICTORY SAGAMU REMO COOP MULTI SOC LTD/LOAN 50,000.00 10/06/2025   9,373,276.55 10/06/2025   NIP/ROLEZ/Bulky Babes/from adedeji bukola no 320/AT68 TRF2MPT2wjgd1932403925729718273 5,000.00 10/06/2025   9,378,276.55 10/06/2025   UP-IB Online Transfer/000004250610135024563317183839| UPI- 17581555gt7i9s86rKcWuh//20250610/MOB/UT O/VICTORY SAGAMU/Famuyiwa Ayokun/31121315554|AYOJOY VENTURES 600,000.00 10/06/2025   9,978,276.55 11/06/2025   NIP/FBN/AWOLERI OLUSANYA FUNMILOLA ELIZABETH/FBNMOBILE VICTORY SAGAMU REMO COOP MULTI SOC LTD/MONTHLY CONTRIBUTION 32,000.00 11/06/2025   10,010,276.55 11/06/2025   Loan to Dr Adejumosola/CIB//NIP TFR TO ADEJUMO OLUSOLA ADEDEJI/FCMB   10,000,000.00   11/06/2025   10,276.55 11/06/2025   NIP CHARGE + VAT   53.75   11/06/2025   10,222.80  Page 2 of 6
11/06/2025   CIP/CR//June to VICTORY SAGAMU REMO COOP MULTI SOC LTD. 000013250611102856000217393894 000217393894/FRM OWOSEJE AYODEJI 100,000.00 11/06/2025   110,222.80 12/06/2025   CIP/CR//Transfer from TEMITOPE MODINAT ODUSANYA 100004250612045338134603213429 20,000.00 12/06/2025   130,222.80 12/06/2025   TRF FROM ABOLADE AYOBAMI FOLORUNSHO//TRF TO VICTORY SAGAMU REMO COOP MULTI SOC LTD//G 2,000.00 12/06/2025   132,222.80 12/06/2025   CIP/CR//Via GAPSLITE Savings 2506121310 REF903584419100000700002506121310 to VICTORY SAGAMU REMO COOP MULTI 0002197613 70,000.00 12/06/2025   202,222.80 13/06/2025   CIP/CR//NIP Transfer to VICTORY SAGAMU REMO COOP MULTI SOC LTD. 000013250613000134000220960470 000220960470/FRM OBA LAR 160,000.00 12/06/2025   362,222.80 13/06/2025   :ETZ INFLOW 09FG250613095003498LNJ1A1:Transfer from FOLASADE FLORENCE OLAITAN; 45,000.00 13/06/2025   407,222.80 13/06/2025   CIP/CR//NIP Transfer to VICTORY SAGAMU REMO COOP MULTI SOC LTD. 000013250613104655000221461552 000221461552/FRM IFEDE K 20,000.00 13/06/2025   427,222.80 14/06/2025   Youth coop seminar Expenses /CIB//NIP TFR TO ADENIKE ALICE IBIGBAMI/WBP   55,000.00   14/06/2025   372,222.80 14/06/2025   NIP CHARGE + VAT   53.75   14/06/2025   372,169.05 15/06/2025   FGN ELECTRONIC MONEY TRANSFER LEVY   550.00   15/06/2025   371,619.05 15/06/2025   NIP/ROLEZ/MCFAT VENTURE - THE FAT VENTURE/Mummy Dammy/AT68 TRF2MPT2ss5x1934156465636925440 80,000.00 15/06/2025   451,619.05 15/06/2025   CIP/CR//USSD NIP Transfer from 07030243901 to VICTORY SAGAMU REMO COOP MULTI SOC LTD. 000013250615164915000 0002259094 69,000.00 15/06/2025   520,619.05 16/06/2025   TRF FROM BOLUWATIFE OLAOLUWA IBIGBAMI//TRF TO VICTORY SAGAMU REMO COOP MULTI SOC LTD//Balance 75,000.00 16/06/2025   595,619.05 17/06/2025   NIP/FBN/AJAYI ZACCHAEUS JIMI/FBNMOBILE VICTORY SAGAMU REMO COOP MULTI SOC LTD/CONTRIBUTION 35,000.00 17/06/2025   630,619.05 19/06/2025   Part withdrawal Bukola /CIB//NIP TFR TO SOFOYEKE OLUWABUKOLA/GTB   150,000.00   19/06/2025   480,619.05 19/06/2025   NIP CHARGE + VAT   53.75   19/06/2025   480,565.30 19/06/2025   NIP/WBP/VICTORY COOPERATIVE MULTIP 1015222777/VICTORY SAGAMU REMO COOP BO VICTORY COOPERATIVE M 8,000,000.00 19/06/2025   8,480,565.30 19/06/2025   :ETZ INFLOW 09FG250619210419311VGSHN4:NXG :TRFGARETHFRM KEHINDE VICTORIA GARET 100,000.00 19/06/2025   8,580,565.30 21/06/2025   :ETZ INFLOW 09FG2506211753317480GF6CG:NXG :TRFFROM MR OLUWASEUN OLUKOKUUFRM OL 37,000.00 21/06/2025   8,617,565.30 21/06/2025   TRF FROM ABOLADE AYOBAMI FOLORUNSHO//TRF TO VICTORY SAGAMU REMO COOP MULTI SOC LTD//Cooperative for folorunsho abolade 2,000.00 21/06/2025   8,619,565.30 22/06/2025   FGN ELECTRONIC MONEY TRANSFER LEVY   350.00   22/06/2025   8,619,215.30 23/06/2025   CIP/CR//NIP Transfer to VICTORY SAGAMU REMO COOP MULTI SOC LTD. 000013250623112829000240610350 000240610350/FRM OGBONNA 10,050.00 23/06/2025   8,629,265.30 23/06/2025   UP-IB Online Transfer/000004250623151219253350679947| UPI- 3104152RFy2nfPsq6j4NcS//20250623/MOB/UT O/VICTORY SAGAMU/VCMS/31362175646|ADESOGA D ADEFULU 230,000.00 23/06/2025   8,859,265.30 23/06/2025   CIP/CR//Olanipekun Ajayi to VICTORY SAGAMU REMO COOP MULTI SOC LTD. 000013250623172128000241405747 000241405747/FRM AJA 70,000.00 23/06/2025   8,929,265.30 24/06/2025   ETIISW INFLOW 09FG250624152632480ZUETTU:NXG :TRFGARETHFRM KEHINDE VICTORIA GARET 150,000.00 24/06/2025   9,079,265.30 25/06/2025   CIP/CR//Transfer from MUIBAT OMOBOLANLE AIGBA 100004250625052500135444289390   150,000.00 25/06/2025   9,229,265.30 25/06/2025   NIP/FBN/FANISI OLAJIDE ELISHA/FBNMOBILE VICTORY SAGAMU REMO COOP MULTI SOC LTD/DEPOSIT 50,000.00 25/06/2025   9,279,265.30 25/06/2025   NIP/FBN/FAJUYITAN ADEBISI/FBNMOBILE VICTORY SAGAMU REMO COOP MULTI SOC LTD/JUNE 2025 CONTRIBUTION 400,000.00 25/06/2025   9,679,265.30  Page 3 of 6
25/06/2025   CIP/CR//Faith Odu rent to VICTORY SAGAMU REMO COOP MULTI SOC LTD. 000013250625181653000245756153 000245756153/FRM ODU 200,000.00 25/06/2025   9,879,265.30 25/06/2025   Victor June sitting allow /CIB//NIP TFR TO OLOGUN VICTOR BABALOLA/GTB   12,000.00   25/06/2025   9,867,265.30 25/06/2025   NIP CHARGE + VAT   26.88   25/06/2025   9,867,238.42 25/06/2025   Fade June sitting allow /CIB//NIP TFR TO BANKOLE CECILIA FADE/GTB   4,000.00   25/06/2025   9,863,238.42 25/06/2025   NIP CHARGE + VAT   10.75   25/06/2025   9,863,227.67 25/06/2025   Tope June sitting allow /CIB//NIP TFR TO OLAAJAYI TEMITOPE OMOBOLA/GTB   6,500.00   25/06/2025   9,856,727.67 25/06/2025   NIP CHARGE + VAT   26.88   25/06/2025   9,856,700.79 25/06/2025   Imprest for June/CIB//NIP TFR TO ADENIKE ALICE IBIGBAMI/WBP   20,000.00   25/06/2025   9,836,700.79 25/06/2025   NIP CHARGE + VAT   26.88   25/06/2025   9,836,673.91 25/06/2025   Adenike June sitting allow /CIB//NIP TFR TO ADENIKE ALICE IBIGBAMI/WBP   14,500.00   25/06/2025   9,822,173.91 25/06/2025   NIP CHARGE + VAT   26.88   25/06/2025   9,822,147.03 25/06/2025   Deola June sitting allow /CIB//NIP TFR TO ADEOLA ADEWUMI FALOWO/WBP   4,000.00   25/06/2025   9,818,147.03 25/06/2025   NIP CHARGE + VAT   10.75   25/06/2025   9,818,136.28 25/06/2025   Tola June sitting allow /CIB//NIP TFR TO OMOTOLA AKINJEJI/WBP   4,000.00   25/06/2025   9,814,136.28 25/06/2025   NIP CHARGE + VAT   10.75   25/06/2025   9,814,125.53 25/06/2025   Odusote June sitting allow /CIB//NIP TFR TO NKECHI GORETTI ODUSOTE/WBP   6,500.00   25/06/2025   9,807,625.53 25/06/2025   NIP CHARGE + VAT   26.88   25/06/2025   9,807,598.65 25/06/2025   Femi June sitting allow /CIB//NIP TFR TO FEMI AMUSAN/OPAY   4,000.00   25/06/2025   9,803,598.65 25/06/2025   NIP CHARGE + VAT   10.75   25/06/2025   9,803,587.90 25/06/2025   Bimbo June sitting allow /CIB//NIP TFR TO ABIMBOLA ADEYINKA OFINNI/ABN   4,000.00   25/06/2025   9,799,587.90 25/06/2025   NIP CHARGE + VAT   10.75   25/06/2025   9,799,577.15 25/06/2025   Meroyi June sitting allowance /CIB//NIP TFR TO MEROYI OLUDOTUN AYODEJI/FBN   12,000.00   25/06/2025   9,787,577.15 25/06/2025   NIP CHARGE + VAT   26.88   25/06/2025   9,787,550.27 25/06/2025   Jerry June sitting allow /CIB//NIP TFR TO SOFOYEKE ADESINA JEREMIAH/FBN   4,000.00   25/06/2025   9,783,550.27 25/06/2025   NIP CHARGE + VAT   10.75   25/06/2025   9,783,539.52 25/06/2025   NIP/STBC/BUKOLA OYESORO/00   15,000.00 25/06/2025   9,798,539.52 26/06/2025   NIP/WBP/OLUWATOSIN IBUKUN IBIGBAMI/Zenith Bank-   5,000.00 26/06/2025   9,803,539.52 26/06/2025   NIP/ROLEZ/MCFAT VENTURE - THE FAT VENTURE/Loan Repayment/AT68 TRF2MPT2ss5x1938191394734628864 10,000.00 26/06/2025   9,813,539.52 27/06/2025   CIP/CR//Transfer from PAUL OLORUNSOGO ODUSANYA 100004250627060858135580318392 10,000.00 27/06/2025   9,823,539.52 27/06/2025   Owo group june/CIB//NIP TFR TO OWOLOWO C T C U LTD SAGAMU/SKYE   250,000.00   27/06/2025   9,573,539.52 27/06/2025   NIP CHARGE + VAT   53.75   27/06/2025   9,573,485.77 27/06/2025   Development levy June /CIB//NIP TFR TO OWOLOWO C T C U LTD SAGAMU/SKYE   40,000.00   27/06/2025   9,533,485.77 27/06/2025   NIP CHARGE + VAT   26.88   27/06/2025   9,533,458.89 27/06/2025   General meeting refreshment , June/CIB//NIP TFR TO ABIMBOLA ADEYINKA OFINNI/ABN   25,000.00   27/06/2025   9,508,458.89 27/06/2025   NIP CHARGE + VAT   26.88   27/06/2025   9,508,432.01 27/06/2025   Event center/CIB//NIP TFR TO OWOLOWO C T C U LTD SAGAMU/SKYE   250,000.00   27/06/2025   9,258,432.01 27/06/2025   NIP CHARGE + VAT   53.75   27/06/2025   9,258,378.26 27/06/2025   Contribution /CIB//NIP TFR TO REMO CO-OP SOC LOAN SCHEME A/C/SKYE   50,000.00   27/06/2025   9,208,378.26 27/06/2025   NIP CHARGE + VAT   26.88   27/06/2025   9,208,351.38 27/06/2025   NIP/ROLEZ/ADEOYE SAMUEL ODUWAYE/ODUWAYE SAMUEL LOAN REPAYMENT /AT68 TRF2MPT9pm8r1938633855233773568 50,000.00 27/06/2025   9,258,351.38 27/06/2025   NIP/FBN/EJERE ODIGUE FRIDAY ILOYEDE/FBNMOBILE VICTORY SAGAMU REMO COOP MULTI SOC LTD/LOAN REPAYMENT FOR MAY 2025 750,000.00 27/06/2025   10,008,351.38 28/06/2025   CIP/CR//NIP Transfer to VICTORY SAGAMU REMO COOP MULTI SOC LTD. 000013250628151254000252167275 000252167275/FRM ABRAHAM 300,000.00 28/06/2025   10,308,351.38 28/06/2025   :ETZ INFLOW 09FG250628174850758BZKT5F:Transfer from FUNMILAYO FUNKE BABALOLA;8 5,000.00 28/06/2025   10,313,351.38 29/06/2025   FGN ELECTRONIC MONEY TRANSFER LEVY   650.00   29/06/2025   10,312,701.38  Page 4 of 6
29/06/2025   TRF FROM ADESOLA OLUFUNMILAYO ABIODUN//TRF TO VICTORY SAGAMU REMO COOP MULTI SOC LTD//Loan repayment 1,090,000.00 29/06/2025   11,402,701.38 29/06/2025   TRF FROM PRISCILLA TITILAYO AIZEBEOKHAI//TRF TO VICTORY SAGAMU REMO COOP MULTI SOC LTD//Savings 10,000.00 29/06/2025   11,412,701.38 29/06/2025   CIP/CR//Transfer from ADEMOLA MICHEAL ADENIYI 100004250629112434135738531057   50,000.00 29/06/2025   11,462,701.38 29/06/2025   SMS CHARGE JUN 2025   1,064.00   28/06/2025   11,461,637.38 29/06/2025   NIP/FBN/AYANJOKE MODUPE ADEFOLAKE/FBNMOBILE VICTORY SAGAMU REMO COOP MULTI SOC LTD/LOAN REFUND REMNANTS BALANCE 15,000.00 29/06/2025   11,476,637.38 29/06/2025   :ETZ INFLOW 09FG250629133636053J8JNXU:June payment   10,000.00 29/06/2025   11,486,637.38 29/06/2025   NIP/FBN/JEMINUSI MRS OLUYEMISI/FBNMOBILE VICTORY SAGAMU REMO COOP MULTI SOC LTD/JEMINUSI 130,000.00 29/06/2025   11,616,637.38 29/06/2025   UP-IB Online Transfer/000004250629182001391235203320| UPI- 3521032HlKAtmOABLDSdD7//20250629/MOB/ UTO/VICTORY SAGAMU/Monthly Contrib/31483561328|ADEJUMO ESTHER NGOZI 100,000.00 29/06/2025   11,716,637.38 29/06/2025   NIP/STLB/OSILOJO OLASIMBO OLABIMPE/Transfer from OSILOJO OLASIMBO OLABIMPE to VICTORY SAGAMU REMO COOP MULTI SOC LT 20,000.00 29/06/2025   11,736,637.38 29/06/2025   CIP/CR//NIP Transfer to VICTORY SAGAMU REMO COOP MULTI SOC LTD. 000013250629194447000254604035 000254604035/FRM SOLESI 500,000.00 29/06/2025   12,236,637.38 29/06/2025   CIP/CR//Fehintola Solesi Loan Repayment to VICTORY SAGAMU REMO COOP MULTI SOC LTD. 0000132506291945460002546 0002546055 500,000.00 29/06/2025   12,736,637.38 29/06/2025   CIP/CR//Part payment of loan Kehinde OA to VICTORY SAGAMU REMO COOP MULTI SOC LTD. 0000132506292030010002546 0002546860 35,000.00 29/06/2025   12,771,637.38 29/06/2025   NIP/FBN/MEROYI OLUDOTUN AYODEJI/FBNMOBILE VICTORY SAGAMU REMO COOP MULTI SOC LTD/LOAN REPAYMENT 250,000.00 29/06/2025   13,021,637.38 30/06/2025   NIP/ROLEZ/LOLU WUNMI GLOBAL VENTURES/Transfer from Osidibo/AT68 TRF2MPT35slt1939560468302184448 75,000.00 29/06/2025   13,096,637.38 30/06/2025   NIP/ROLEZ/LOLU WUNMI GLOBAL VENTURES/Transfer from Wunmi Osidibo/AT68 TRF2MPT35slt1939565398151147520 50,000.00 29/06/2025   13,146,637.38 30/06/2025   CIP/CR//Transfer from PAUL OLORUNSOGO ODUSANYA 100004250630060348135780736641 15,000.00 29/06/2025   13,161,637.38 30/06/2025   CIP/CR//Repayment to VICTORY SAGAMU REMO COOP MULTI SOC LTD. 000013250630092604000255230322 000255230322/FRM OSOARE OYI 50,000.00 30/06/2025   13,211,637.38 30/06/2025   TRF FROM TERMINUS VENTURE GLOBAL SERVICE//TRF TO VICTORY SAGAMU REMO COOP MULTI SOC LTD//June loan repayment Odumesi olusesan 2,500,000.00 30/06/2025   15,711,637.38 30/06/2025   :ETZ INFLOW 09FG250630130423646QQSBAX:NXG :TRFLOAN REPAYMENT- NO 3 DAPO OGUNYI 800,000.00 30/06/2025   16,511,637.38 30/06/2025   ISW ATMPyt-009200653749-GTBank 143, Akarigbo Str Sabo SagamuOGNG   10,000.00 30/06/2025   16,521,637.38 30/06/2025   :ETZ INFLOW 09FG2506301355264027QC789:Transfer from AARON IREOLUWA OLOGUN;8109 5,000.00 30/06/2025   16,526,637.38 30/06/2025   TRF FROM PETER IFEOLUWA OSILOJO//TRF TO VICTORY SAGAMU REMO COOP MULTI SOC LTD//Cooperative payment for June 2025 52,000.00 30/06/2025   16,578,637.38 30/06/2025   NIP/PALM/SARATU YUSUF/iseal Adetola   5,000.00 30/06/2025   16,583,637.38 30/06/2025   NIP/PALM/SARATU YUSUF/from mr Adetola James   20,000.00 30/06/2025   16,603,637.38 30/06/2025   CIP/CR//Loan form proceeds March to June to VICTORY SAGAMU REMO COOP MULTI SOC LTD. 000013250630173540000256 0002564989 16,000.00 30/06/2025   16,619,637.38 30/06/2025   UP-IB Online Transfer/000004250630181748402631391353| UPI- 3595580qU6xnAmp8FI9Qpk//20250630/MOB/U TO/VICTORY SAGAMU/contribution /31503357636|EJERE REBECCA ONOME 500,000.00 30/06/2025   17,119,637.38  Page 5 of 6
30/06/2025   NIP/WBP/ADEFULU TOLORUNJU JULIE/ZENITH BANK-Cov co-op   30,000.00 30/06/2025   17,149,637.38 30/06/2025   CIP/CR//Towards loan repayment. to VICTORY SAGAMU REMO COOP MULTI SOC LTD. 000013250630192848000256815597 000256815597/ 200,000.00 30/06/2025   17,349,637.38 30/06/2025   NIP/ROLEZ/SOGBESAN MUJIDAT OYINLOLA/SOGBESAN MUJ Trf for Customer/AT68 TRF2MPT4sdg31939756007560785920 20,000.00 30/06/2025   17,369,637.38 30/06/2025   NIP/STBC/COMFORT OLUWAKEMI OKEOWO/Loans Refund for the   25,000.00 30/06/2025   17,394,637.38 TOTALS   23,622,438.55   24,604,050.00 TOTAL (CLEARED + UNCLEARED)   23,622,438.55   24,604,050.00   17,394,637.38 ZENITHDIRECT - 24/7 CUSTOMER CONTACT CENTER OUR ZENITHDIRECT CONTACT CENTER GIVES YOU ROUND THE CLOCK ACCESS TO YOUR ACCOUNT(S). ENROL TODAY THROUGH INTERNET BANKING, BY VISITING ANY OF OUR BRANCHES OR BY CALLING ZENITHDIRECT ON: 0201-2787000. TO AVOID CHEQUE RELATED FRAUD IN YOUR ACCOUNT, WE IMPLORE YOU TO KEEP YOUR CHEQUE BOOKS AWAY FROM UNAUTHORIZED PERSONS. YOU HAVE THE RIGHT TO NEGOTIATE INTEREST/CHARGES ON YOUR ACCOUNT IN LINE WITH THE PROVISIONS OF THE CBN GUIDE TO BANK CHARGES.  Page 6 of 6";
echo "<h2>Testing with Bank Statement Data</h2>";
echo "<p>Text length: " . strlen($sample_text) . " characters</p>";

// Test 1: Small text (should work)
echo "<h3>Test 1: Small Text (First 1000 chars)</h3>";
testOpenAIWithText(substr($sample_text, 0, 1000), $openai_key);

// Test 2: Medium text (should work)
echo "<h3>Test 2: Medium Text (First 2000 chars)</h3>";
testOpenAIWithText(substr($sample_text, 0, 2000), $openai_key);

// Test 3: Large text (might timeout)
echo "<h3>Test 3: Large Text (First 4000 chars)</h3>";
testOpenAIWithText($sample_text, $openai_key);

function testOpenAIWithText($text, $api_key) {
    try {
        echo "<p>üîç Making OpenAI API request...</p>";
        echo "<p>Text length: " . strlen($text) . " characters</p>";
        
        $start_time = microtime(true);
        
        $client = new \GuzzleHttp\Client([
            'timeout' => 60,  // Increased timeout
            'connect_timeout' => 15
        ]);
        
        $prompt = "Extract financial transactions from the following Nigerian bank statement text. 
        Look for transaction names, amounts, and whether they are credits (money received) or debits (money sent).
        Focus on Nigerian names and currency amounts in Naira (‚Ç¶).
        Return the data in JSON format with this structure:
        [{\"name\": \"Person Name\", \"amount\": 1000.00, \"type\": \"credit\" or \"debit\"}]
        
        Bank statement text:
        " . $text;
        
        echo "<p>üì§ Sending request to OpenAI...</p>";
        
        $response = $client->post('https://api.openai.com/v1/chat/completions', [
            'headers' => [
                'Authorization' => 'Bearer ' . $api_key,
                'Content-Type' => 'application/json',
            ],
            'json' => [
                'model' => 'gpt-3.5-turbo',
                'messages' => [
                    [
                        'role' => 'system',
                        'content' => 'You are a financial data extraction specialist. Extract transaction details from bank statements accurately.'
                    ],
                    [
                        'role' => 'user',
                        'content' => $prompt
                    ]
                ],
                'temperature' => 0.1,
                'max_tokens' => 2000
            ]
        ]);
        
        $end_time = microtime(true);
        $duration = round($end_time - $start_time, 2);
        
        echo "<p>‚úÖ Response received in {$duration} seconds!</p>";
        echo "<p>Status Code: " . $response->getStatusCode() . "</p>";
        
        $result = json_decode($response->getBody(), true);
        
        if (isset($result['choices'][0]['message']['content'])) {
            $content = $result['choices'][0]['message']['content'];
            
            echo "<p>üìÑ Raw AI response (first 500 chars):</p>";
            echo "<div style='background: #f0f0f0; padding: 10px; border: 1px solid #ccc; font-family: monospace; font-size: 12px; max-height: 200px; overflow-y: auto;'>";
            echo htmlspecialchars(substr($content, 0, 500));
            echo "</div>";
            
            preg_match('/\[.*\]/s', $content, $matches);
            if (isset($matches[0])) {
                echo "<p>üîç JSON array found in response.</p>";
                $transactions = json_decode($matches[0], true);
                if (is_array($transactions)) {
                    echo "<p>‚úÖ JSON parsed successfully!</p>";
                    echo "<p>Transactions found: " . count($transactions) . "</p>";
                    if (!empty($transactions)) {
                        echo "<div style='background: #e8f5e8; padding: 10px; border: 1px solid #28a745;'>";
                        echo "<pre>" . print_r($transactions, true) . "</pre>";
                        echo "</div>";
                    }
                } else {
                    echo "<p>‚ùå JSON parsing failed.</p>";
                }
            } else {
                echo "<p>‚ùå No JSON array found in response.</p>";
            }
        } else {
            echo "<p>‚ùå No content in OpenAI response.</p>";
            echo "<pre>" . print_r($result, true) . "</pre>";
        }
        
    } catch (\GuzzleHttp\Exception\ConnectException $e) {
        echo "<p style='color: red;'>‚ùå Connection Error: " . $e->getMessage() . "</p>";
    } catch (\GuzzleHttp\Exception\ClientException $e) {
        echo "<p style='color: red;'>‚ùå Client Error (4xx): " . $e->getMessage() . "</p>";
        echo "<p>Response: " . $e->getResponse()->getBody() . "</p>";
    } catch (\GuzzleHttp\Exception\ServerException $e) {
        echo "<p style='color: red;'>‚ùå Server Error (5xx): " . $e->getMessage() . "</p>";
        echo "<p>Response: " . $e->getResponse()->getBody() . "</p>";
    } catch (\GuzzleHttp\Exception\RequestException $e) {
        echo "<p style='color: red;'>‚ùå Request Error: " . $e->getMessage() . "</p>";
    } catch (Exception $e) {
        echo "<p style='color: red;'>‚ùå General Error: " . $e->getMessage() . "</p>";
    }
    
    echo "<hr>";
}
?>